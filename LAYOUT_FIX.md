# üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è Layout Save/Load

## ‚úÖ –©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ

### –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:

1. **handleSaveLayout** - –ø–æ–∫—Ä–∞—â–µ–Ω–æ:
   - ‚úÖ –î–æ–¥–∞–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö custom –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –æ–±'—î–∫—Ç—ñ–≤
   - ‚úÖ –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
   - ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö/–ø–æ–º–∏–ª–∫—É
   - ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç—ñ–Ω–µ–π, opacity, cornerStyle —ñ —ñ–Ω—à–∏—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π

2. **handleLoadLayout** - –ø–æ–∫—Ä–∞—â–µ–Ω–æ:
   - ‚úÖ –î–æ–¥–∞–Ω–æ –æ—á–∏—â–µ–Ω–Ω—è canvas –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º
   - ‚úÖ –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
   - ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
   - ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `requestRenderAll()` –∑–∞–º—ñ—Å—Ç—å `renderAll()`

3. **ObjectToolbar** - –ø–æ–∫—Ä–∞—â–µ–Ω–æ:
   - ‚úÖ –î–æ–¥–∞–Ω–æ emoji —ñ–∫–æ–Ω–∫–∏ (üíæ Save, üìÇ Load)
   - ‚úÖ –î–æ–¥–∞–Ω–æ –∫–Ω–æ–ø–∫—É "üóëÔ∏è Clear All"
   - ‚úÖ –î–æ–¥–∞–Ω–æ –ø—ñ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ "üíæ Layout Management"
   - ‚úÖ –î–æ–¥–∞–Ω–æ tooltips –¥–ª—è –∫–Ω–æ–ø–æ–∫

## üß™ –Ø–∫ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏

### –ö—Ä–æ–∫ 1: –í—ñ–¥–∫—Ä–∏–π—Ç–µ Developer Console
```
Chrome/Edge: F12 –∞–±–æ Ctrl+Shift+I
Firefox: F12 –∞–±–æ Ctrl+Shift+K
Safari: Cmd+Option+I
```

### –ö—Ä–æ–∫ 2: –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É
–£ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞ –≤–∏–∫–æ–Ω–∞–π—Ç–µ:
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ localStorage
console.log('Layouts:', localStorage.getItem('IFM_LAYOUTS'));

// –ê–±–æ —Å–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É layout-diagnostics.js
```

### –ö—Ä–æ–∫ 3: –¢–µ—Å—Ç Save
1. –î–æ–¥–∞–π—Ç–µ –∫—ñ–ª—å–∫–∞ –æ–±'—î–∫—Ç—ñ–≤ –Ω–∞ canvas:
   - Hospital Bed
   - Mini Fridge
   - Oxygen Cylinder
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **‚ò∞ Menu**
3. –ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å –¥–æ **"üíæ Layout Management"**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"üíæ Save Layout"**
5. –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: "Test Room 1"
6. –û—á—ñ–∫—É–π—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: **"‚úÖ Layout 'Test Room 1' saved successfully!"**

### –ö—Ä–æ–∫ 4: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Console
–£ –∫–æ–Ω—Å–æ–ª—ñ –º–∞—î –∑'—è–≤–∏—Ç–∏—Å—è:
```
üíæ Saving layout: Test Room 1 {...}
‚úÖ Layout saved successfully. Total layouts: 1
```

### –ö—Ä–æ–∫ 5: –¢–µ—Å—Ç Load
1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"üóëÔ∏è Clear All"** (—â–æ–± –æ—á–∏—Å—Ç–∏—Ç–∏ canvas)
2. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –æ—á–∏—â–µ–Ω–Ω—è
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **‚ò∞ Menu** ‚Üí **"üìÇ Load Layout"**
4. –í–∏–±–µ—Ä—ñ—Ç—å –Ω–æ–º–µ—Ä layout (—è–∫—â–æ —ó—Ö –∫—ñ–ª—å–∫–∞) –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å OK
5. –û—á—ñ–∫—É–π—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: **"‚úÖ Layout 'Test Room 1' loaded!"**
6. –í—Å—ñ –æ–±'—î–∫—Ç–∏ –º–∞—é—Ç—å –∑'—è–≤–∏—Ç–∏—Å—è –Ω–∞ —Å–≤–æ—ó—Ö –º—ñ—Å—Ü—è—Ö!

### –ö—Ä–æ–∫ 6: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Console
–£ –∫–æ–Ω—Å–æ–ª—ñ –º–∞—î –∑'—è–≤–∏—Ç–∏—Å—è:
```
üìÇ Loading layouts from storage: Found
üìã Found 1 saved layouts
üîÑ Loading single layout: Test Room 1
‚úÖ Layout loaded successfully
```

## üêõ –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "No saved layouts found"
**–ü—Ä–∏—á–∏–Ω–∞:** localStorage –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –æ—á–∏—â–µ–Ω–æ  
**–†—ñ—à–µ–Ω–Ω—è:**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—ñ:
localStorage.getItem('IFM_LAYOUTS')
// –Ø–∫—â–æ null - layout –Ω–µ –∑–±–µ—Ä—ñ–≥—Å—è
```

**–ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è:**
1. –î–æ–¥–∞–π—Ç–µ –æ–±'—î–∫—Ç–∏ –Ω–∞ canvas
2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ DevTools ‚Üí Application ‚Üí Local Storage
3. –ó–Ω–∞–π–¥—ñ—Ç—å –∫–ª—é—á `IFM_LAYOUTS`
4. –ü—ñ—Å–ª—è Save Layout –ø–æ–≤–∏–Ω–µ–Ω –∑'—è–≤–∏—Ç–∏—Å—è –∑–∞–ø–∏—Å

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Layout –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è, –∞–ª–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–º–∏–ª–∫–∞ –≤ JSON  
**–†—ñ—à–µ–Ω–Ω—è:**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ JSON –≤ –∫–æ–Ω—Å–æ–ª—ñ:
const data = JSON.parse(localStorage.getItem('IFM_LAYOUTS'));
console.log('First layout:', data[0]);
console.log('Objects:', data[0].json.objects);
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û–±'—î–∫—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è, –∞–ª–µ –≤–∏–≥–ª—è–¥–∞—é—Ç—å —ñ–Ω–∞–∫—à–µ
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –≤—Å—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è  
**–†—ñ—à–µ–Ω–Ω—è:** –í–∂–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ! –¢–µ–ø–µ—Ä –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è:
- shadow
- opacity
- cornerStyle
- objectCaching
- src (–¥–ª—è –∑–æ–±—Ä–∞–∂–µ–Ω—å)
- crossOrigin

### –ü—Ä–æ–±–ª–µ–º–∞ 4: localStorage –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–≤–∞—Ç–Ω–∏–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ –∞–±–æ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è  
**–†—ñ—à–µ–Ω–Ω—è:**
```javascript
// –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ:
try {
  localStorage.setItem('test', '1');
  localStorage.removeItem('test');
  console.log('‚úÖ localStorage –ø—Ä–∞—Ü—é—î');
} catch(e) {
  console.error('‚ùå localStorage –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ:', e);
}
```

## üìä –î—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

### –ü–µ—Ä–µ–≥–ª—è–¥ –≤—Å—ñ—Ö –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö layouts:
```javascript
const layouts = JSON.parse(localStorage.getItem('IFM_LAYOUTS') || '[]');
layouts.forEach((l, i) => {
  console.log(`${i+1}. ${l.name} - ${l.json.objects?.length || 0} objects`);
});
```

### –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ layout:
```javascript
const layouts = JSON.parse(localStorage.getItem('IFM_LAYOUTS') || '[]');
// –í–∏–¥–∞–ª–∏—Ç–∏ –ø–µ—Ä—à–∏–π (—ñ–Ω–¥–µ–∫—Å 0)
layouts.splice(0, 1);
localStorage.setItem('IFM_LAYOUTS', JSON.stringify(layouts));
console.log('Layout deleted');
```

### –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ layouts:
```javascript
localStorage.removeItem('IFM_LAYOUTS');
console.log('All layouts cleared');
```

### –ï–∫—Å–ø–æ—Ä—Ç layout —É —Ñ–∞–π–ª:
```javascript
const layouts = localStorage.getItem('IFM_LAYOUTS');
const blob = new Blob([layouts], {type: 'application/json'});
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = 'layouts-backup.json';
a.click();
console.log('Layouts exported');
```

### –Ü–º–ø–æ—Ä—Ç layout –∑ —Ñ–∞–π–ª—É:
```javascript
// 1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–µ–∫—Å—Ç
// 2. –ü–æ—Ç—ñ–º:
const imported = '...–≤—Å—Ç–∞–≤—Ç–µ JSON —Ç—É—Ç...';
localStorage.setItem('IFM_LAYOUTS', imported);
console.log('Layouts imported');
```

## üéØ –û—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞

### –ü—Ä–∏ Save:
1. ‚úÖ Prompt –∑ –Ω–∞–∑–≤–æ—é layout
2. ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ localStorage
3. ‚úÖ Alert "‚úÖ Layout saved successfully!"
4. ‚úÖ Console log –∑ –¥–µ—Ç–∞–ª—è–º–∏

### –ü—Ä–∏ Load:
1. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ layouts
2. ‚úÖ –Ø–∫—â–æ 1 - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
3. ‚úÖ –Ø–∫—â–æ –±—ñ–ª—å—à–µ - prompt –∑ –≤–∏–±–æ—Ä–æ–º
4. ‚úÖ –û—á–∏—â–µ–Ω–Ω—è canvas
5. ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤
6. ‚úÖ Alert "‚úÖ Layout loaded!"
7. ‚úÖ Console log –∑ –¥–µ—Ç–∞–ª—è–º–∏

### –ü—Ä–∏ Clear All:
1. ‚úÖ Confirm –¥—ñ–∞–ª–æ–≥
2. ‚úÖ –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
3. ‚úÖ –ß–∏—Å—Ç–∏–π canvas

## üîç –ü–µ—Ä–µ–≤—ñ—Ä–æ—á–Ω–∏–π —á–µ–∫–ª–∏—Å—Ç

- [ ] Browser console –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- [ ] Save Layout –ø–æ–∫–∞–∑—É—î success message
- [ ] localStorage –º—ñ—Å—Ç–∏—Ç—å 'IFM_LAYOUTS' –∫–ª—é—á
- [ ] Load Layout –ø–æ–∫–∞–∑—É—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ layouts
- [ ] –ü—ñ—Å–ª—è Load –æ–±'—î–∫—Ç–∏ –∑'—è–≤–ª—è—é—Ç—å—Å—è
- [ ] –¢—ñ–Ω—ñ —Ç–∞ —Å—Ç–∏–ª—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è
- [ ] –ü–æ–∑–∏—Ü—ñ—ó –æ–±'—î–∫—Ç—ñ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ
- [ ] –†–æ–∑–º—ñ—Ä–∏ –æ–±'—î–∫—Ç—ñ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ
- [ ] –ú–æ–∂–Ω–∞ –∑–±–µ—Ä–µ–≥—Ç–∏ –∫—ñ–ª—å–∫–∞ layouts
- [ ] –ú–æ–∂–Ω–∞ –≤–∏–±—Ä–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π layout

## üí° –ü–æ—Ä–∞–¥–∏

1. **–†–µ–≥—É–ª—è—Ä–Ω—ñ –±–µ–∫–∞–ø–∏**: –ï–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ layouts —É JSON —Ñ–∞–π–ª–∏
2. **–Ü–º–µ–Ω—É–≤–∞–Ω–Ω—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑—Ä–æ–∑—É–º—ñ–ª—ñ –Ω–∞–∑–≤–∏ (Room 101, ICU Setup)
3. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –ó–∞–≤–∂–¥–∏ —Ç–µ—Å—Ç—É–π—Ç–µ Load –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è Save
4. **Console**: –¢—Ä–∏–º–∞–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
5. **–û–±–º–µ–∂–µ–Ω–Ω—è**: localStorage –º–∞—î –ª—ñ–º—ñ—Ç ~5-10MB

## üìà –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### –©–æ –±—É–ª–æ –¥–æ–¥–∞–Ω–æ:
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö custom –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π
- ‚úÖ –û—á–∏—â–µ–Ω–Ω—è canvas –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º
- ‚úÖ –ö—Ä–∞—â—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
- ‚úÖ Emoji —ñ–∫–æ–Ω–∫–∏ –¥–ª—è –∫—Ä–∞—â–æ—ó UX
- ‚úÖ –ö–Ω–æ–ø–∫–∞ Clear All
- ‚úÖ Tooltips –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö

### –©–æ –º–æ–∂–Ω–∞ —â–µ –¥–æ–¥–∞—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):
- [ ] –ö–Ω–æ–ø–∫–∞ "Export Layouts" –¥–ª—è –±–µ–∫–∞–ø—É
- [ ] –ö–Ω–æ–ø–∫–∞ "Import Layouts" –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
- [ ] –ü—Ä–µ–≤—å—é layouts (thumbnails)
- [ ] –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–¥–∞–ª–µ–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö layouts
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ —Ö–º–∞—Ä–æ—é (Firebase, —Ç–æ—â–æ)
- [ ] Undo/Redo —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä Save/Load Layout –º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–¥—ñ–π–Ω–æ –∑:
- ‚úÖ –ü–æ–≤–Ω–∏–º –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –≤—Å—ñ—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∏–º –ª–æ–≥—É–≤–∞–Ω–Ω—è–º –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –ö—Ä–∞—â–∏–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
- ‚úÖ –ù–æ–≤–æ—é –∫–Ω–æ–ø–∫–æ—é Clear All

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–ò–ü–†–ê–í–õ–ï–ù–û  
**–î–∞—Ç–∞:** 6 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025  
**–í–µ—Ä—Å—ñ—è:** 2.1.0
